<!DOCTYPE html>
<html>

<head>
    <title>TJ Physics Team</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="CSS/main.css">
    <link rel="stylesheet" href="CSS/schedule.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp" rel="stylesheet">
    <link rel="stylesheet" type="text/css"
        href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <link href='JS/calendar/core/main.css' rel='stylesheet' />
    <link href='JS/calendar/daygrid/main.css' rel='stylesheet' />
    <script src='JS/calendar/core/main.js'></script>
    <script src='JS/calendar/daygrid/main.js'></script>
    <script src="JS/papaparse.min.js"></script>
    <script src="JS/schedule.js"></script>
    <script src="JS/main.js"></script>
    <link rel="icon" href="Pics/copy.png">

</head>

<body>
    <nav class="navbar fixed-top">
        <div class="left">
            <a href="index.html"><span>Home</span></a>
            <a href="schedule.html"><span class="active">Schedule</span></a>
            <a href="events.html"><span>Events</span></a>
            <a href="rankings.html"><span>Rankings</span></a>
        </div>
        <a href="index.html"><img src="Pics/copy2.png"></a>
        <div class="right">
            <a href="a.html"><span>A Team</span></a>
            <a href="b.html"><span>B Team</span></a>
            <a href="c.html"><span>C Team</span></a>
            <a href="past.html"><span>Past</span></a>
            <a href="resources.html"><span>Resources</span></a>
        </div>
    </nav>

    <div class="side" vis="off">
        <p class="date"></p>
        <p class="title"></p>
        <p class="desc"></p>
    </div>

    <div class="wrap">
        <div id='calendar'></div>
    </div>

    <div class="foot-wrap">
    </div>
</body>
<script>
    var calendarEl = document.getElementById('calendar');

    var monthconvert = {
        'Jan': 'January',
        'Feb': "February",
        'Mar': "March",
        'Apr': "April",
        'May': "May",
        'Jun': "June",
        'Jul': "July",
        'Aug': "August",
        'Sep': "September",
        'Oct': "October",
        'Nov': "November",
        'Dec': "December"
    }

    var previnfo = "";

    var calendar = new FullCalendar.Calendar(calendarEl, {
        plugins: ['dayGrid'],
        eventOrder: 'color,start',
        eventClick: function (info) {
            // alert('Event: ' + info.event.title);
            $(".side .date").text(monthconvert[(info.event.start + " ").split(" ")[1]] + " " + (
                info.event.start + " ").split(" ")[2]);
            var team;
            var desc = info.event.id;
            if (info.event.backgroundColor == "#06D6A0")
                team = "A Team " + "<a href='" + desc.split(' __ ')[0] +
                "' target='_blank'>Lecture</a>" + " on ";
            else if (info.event.backgroundColor == "#1B98E0")
                team = "B Team " + "<a href='" + desc.split(' __ ')[0] +
                "' target='_blank'>Lecture</a>" + " on ";
            else
                team = "C Team " + "<a href='" + desc.split(' __ ')[0] +
                "' target='_blank'>Lecture</a>" + " on ";
            console.log(info.event);
            $(".side .title").html(team + info.event.title);
            $(".side .desc").html(desc.split(" __ ")[1]);
            // alert($(".side").css("transform"));

            if ($(".side").attr("vis") == "off") {
                $(".side").css("transform", "translateX(25%)");
                $(".wrap").css("transform", "translateX(20%)");
                $(".wrap").css("width", "65%");
                $(".side").attr("vis", "on");
            } else if (previnfo != "" && previnfo == info.event.start + info.event.title + info
                .event
                .backgroundColor) {
                $(".side").css("transform", "translateX(-100%)");
                $(".wrap").css("transform", "translateX(0%)");
                $(".wrap").css("width", "75%");
                $(".side").attr("vis", "off");
            }
            previnfo = info.event.start + info.event.title + info.event.backgroundColor;
        }
    });

    var reqa =
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vQceVGvkhRKu73a7grDmOPnr0kQ1hBomcButE_ERqf4BlhbuJ1LLYWzZOFVKBo0wsVz4bupKXtlMk1A/pub?gid=0&single=true&output=csv";

    var reqb =
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vQceVGvkhRKu73a7grDmOPnr0kQ1hBomcButE_ERqf4BlhbuJ1LLYWzZOFVKBo0wsVz4bupKXtlMk1A/pub?gid=626361445&single=true&output=csv";

    var reqc =
        "https://docs.google.com/spreadsheets/d/e/2PACX-1vQceVGvkhRKu73a7grDmOPnr0kQ1hBomcButE_ERqf4BlhbuJ1LLYWzZOFVKBo0wsVz4bupKXtlMk1A/pub?gid=993140585&single=true&output=csv";

    getDoc(reqa, '#06D6A0');
    getDoc(reqb, '#1B98E0');
    getDoc(reqc, '#3D348B');

    function getDoc(req, color) {
        $.ajax({
            url: req,
            type: "get",
            async: false,
            success: function (data) {
                var arr = Papa.parse(data).data;
                console.log(arr);
                for (i = 0; i < arr.length; i++) {
                    var month = arr[i][0].split("/")[0];
                    month = month.length > 1 ? month : '0' + month;

                    var day = arr[i][0].split("/")[1];
                    day = day.length > 1 ? day : '0' + day;

                    var year = 2020;

                    if (parseInt(month) > 0 && parseInt(month) < 7)
                        year = 2021;

                    var dateStr = year + "-" + month + "-" + day;
                    var date = new Date(dateStr + 'T00:00:00');

                    calendar.addEvent({
                        title: arr[i][1],
                        start: date,
                        allDay: true,
                        backgroundColor: color,
                        id: arr[i][3] + " __ " + arr[i][2]
                    });
                }
            }
        });
    };

    calendar.render();
</script>
<!-- <div class="block" style="background-color: #06D6A0;"></div>
<div class="block" style="background-color: #3D348B;"></div>
<div class="block" style="background-color: #1B98E0;"></div>
<div class="block" style="background-color: #BB0A21;"></div> -->

</html>