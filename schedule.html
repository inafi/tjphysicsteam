<!DOCTYPE html>
<html>

<head>
    <title>TJ Physics Team</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="CSS/main.css">
    <link rel="stylesheet" href="CSS/schedule.css">
    <link rel="stylesheet" href="fonts/fa/css/all.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous">
    </script>
    <link
        href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
        rel="stylesheet">
    <link href='JS/calendar/core/main.css' rel='stylesheet' />
    <link href='JS/calendar/daygrid/main.css' rel='stylesheet' />
    <script src='JS/calendar/core/main.js'></script>
    <script src='JS/calendar/daygrid/main.js'></script>
    <script src="JS/papaparse.min.js"></script>
    <script src="JS/schedule.js"></script>
    <script src="JS/main.js"></script>
    <script src="JS/ds.min.js"></script>
    <link rel="icon" href="Pics/copy.png">

</head>

<body>
    <nav class="navbar fixed-top navbar-expand-xl">
        <div class="left">
            <a href="index.html"><span>Home</span></a>
            <a href="schedule.html"><span class="active">Schedule</span></a>
            <a href="events.html"><span>Events</span></a>
            <a href="rankings.html"><span>Rankings</span></a>
        </div>
        <a href="index.html"><img src="Pics/copy2.png"></a>
        <div class="right">
            <a href="a.html"><span>A Team</span></a>
            <a href="b.html"><span>B Team</span></a>
            <a href="c.html"><span>C Team</span></a>
            <a href="past.html"><span>Past</span></a>
            <a href="resources.html"><span>Resources</span></a>
        </div>
    </nav>

    <p><span id="clipboard"></span></p>

    <div class="schedule">
        <div class="side" vis="off">
            <p class="date"></p>
            <p class="title"></p>
            <p class="desc"></p>
        </div>

        <div class="wrap">
            <div id='calendar'></div>
        </div>
    </div>

    <div class="foot-wrap">
    </div>
</body>
<script>
    var calendarEl = document.getElementById('calendar');

    var monthconvert = {
        'Jan': 'January',
        'Feb': "February",
        'Mar': "March",
        'Apr': "April",
        'May': "May",
        'Jun': "June",
        'Jul': "July",
        'Aug': "August",
        'Sep': "September",
        'Oct': "October",
        'Nov': "November",
        'Dec': "December"
    }

    var previnfo = "";

    var calendar = new FullCalendar.Calendar(calendarEl, {
        plugins: ['dayGrid'],
        eventOrder: 'color,start',
        eventClick: function (info) {
            // alert('Event: ' + info.event.title);
            $(".side .date").text(monthconvert[(info.event.start + " ").split(" ")[1]] + " " + (
                info.event.start + " ").split(" ")[2]);
            var team;
            var desc = info.event.id;
            var href = "";
            if (desc.split(' __ ')[0] != "")
                href = ' href="' + desc.split(' __ ')[0] + '"';
            if (info.event.backgroundColor == "#06D6A0")
                team = "A Team " + "<a" + href + " target='_blank'>Lecture</a>" + " on ";
            else if (info.event.backgroundColor == "#1B98E0")
                team = "B Team " + "<a" + href + " target='_blank'>Lecture</a>" + " on ";
            else
                team = "C Team " + "<a" + href + " target='_blank'>Lecture</a>" + " on ";
            console.log(info.event);
            $(".side .title").html(team + info.event.title);
            $(".side .desc").html(desc.split(" __ ")[1]);
            // alert($(".side").css("transform"));

            if ($(".side").attr("vis") == "off") {
                $(".side").css("transform", "translateX(25%)");
                $(".wrap").css("transform", "translateX(20%)");
                $(".wrap").css("width", "65%");
                $(".side").attr("vis", "on");
            } else if (previnfo != "" && previnfo == info.event.start + info.event.title + info
                .event
                .backgroundColor) {
                $(".side").css("transform", "translateX(-100%)");
                $(".wrap").css("transform", "translateX(0%)");
                $(".wrap").css("width", "75%");
                $(".side").attr("vis", "off");
            }
            previnfo = info.event.start + info.event.title + info.event.backgroundColor;
        }
    });

    getDoc(1, '#06D6A0');
    getDoc(2, '#1B98E0');
    getDoc(3, '#3D348B');

    function getDoc(req, color) {
        $.ajax({
            url: "https://sheets.googleapis.com/v4/spreadsheets/1-JfkEnNY_z5T_oKnxL70sVwqe-ZKnuOmXHwDXnh0f9g/?key=AIzaSyAjX2wnpSdfn5KkEvaTwXMkTqCXxRRIxm8&includeGridData=true",
            type: "get",
            async: false,
            success: function (data) {
                var arr = data.sheets[req].data[0].rowData;
                num = arr.length;

                for (i = 0; i < arr.length; i++) {
                    var date = "";
                    var title = "";
                    var desc = "";
                    var link = "";
                    try {
                        date = arr[i].values[0].formattedValue;
                        title = arr[i].values[1].formattedValue;
                        desc = arr[i].values[2].formattedValue;
                        link = arr[i].values[3].formattedValue;
                    } catch (err) {

                    }
                    var month = date.split("/")[0];
                    month = month.length > 1 ? month : '0' + month;

                    var day = date.split("/")[1];
                    day = day.length > 1 ? day : '0' + day;

                    var year = 2020;

                    if (parseInt(month) > 0 && parseInt(month) < 7)
                        year = 2021;

                    var dateStr = year + "-" + month + "-" + day;
                    var date = new Date(dateStr + 'T00:00:00');

                    calendar.addEvent({
                        title: title,
                        start: date,
                        allDay: true,
                        backgroundColor: color,
                        id: link + " __ " + desc
                    });
                }
            }
        });
    };

    calendar.render();
</script>
<!-- <div class="block" style="background-color: #06D6A0;"></div>
<div class="block" style="background-color: #3D348B;"></div>
<div class="block" style="background-color: #1B98E0;"></div>
<div class="block" style="background-color: #BB0A21;"></div> -->

</html>